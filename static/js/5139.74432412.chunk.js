"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[5139],{11873:(e,t,r)=>{function s(){return[1,0,0,0,1,0,0,0,1]}function i(e,t,r,s,i,n,o,l,a){return[e,t,r,s,i,n,o,l,a]}function n(e,t){return new Float64Array(e,t,9)}r.d(t,{a:()=>s,c:()=>n,f:()=>i});Object.freeze(Object.defineProperty({__proto__:null,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},create:s,createView:n,fromValues:i},Symbol.toStringTag,{value:"Module"}))},67593:(e,t,r)=>{r.d(t,{E:()=>u,H:()=>c});var s=r(22753),i=r(11873),n=r(88396),o=r(11186);const l=(0,r(71353).c)(),a=(0,i.a)(),h=(0,i.a)(),d=(0,i.a)();function c(e,t,r){return(0,o.s)(l,t[0],t[1],1),(0,o.t)(l,l,(0,s.t)(a,r)),0===l[2]?(0,n.s)(e,l[0],l[1]):(0,n.s)(e,l[0]/l[2],l[1]/l[2])}function u(e,t,r){return p(h,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),p(d,r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7]),(0,s.m)(e,(0,s.a)(h,h),d),0!==e[8]&&(e[0]/=e[8],e[1]/=e[8],e[2]/=e[8],e[3]/=e[8],e[4]/=e[8],e[5]/=e[8],e[6]/=e[8],e[7]/=e[8],e[8]/=e[8]),e}function p(e,t,r,i,n,h,d,c,u){(0,s.s)(e,t,i,h,r,n,d,1,1,1),(0,o.s)(l,c,u,1),(0,s.a)(a,e);const[p,m,f]=(0,o.t)(l,l,(0,s.t)(a,a));return(0,s.s)(a,p,0,0,0,m,0,0,0,f),(0,s.m)(e,a,e)}},59568:(e,t,r)=>{r.d(t,{L:()=>c});var s=r(27366),i=r(7138),n=r(49861),o=(r(25243),r(63780),r(93169),r(69912)),l=r(80885),a=r(45925),h=r(65156),d=r(47991);let c=class extends i.Z{constructor(e){super(e)}get bounds(){const e=this.coords;return null==(null===e||void 0===e?void 0:e.extent)?null:(0,h.oJ)(e.extent)}get coords(){var e;const t=null===(e=this.element.georeference)||void 0===e?void 0:e.coords;return(0,a.projectOrLoad)(t,this.spatialReference).geometry}get normalizedCoords(){return l.Z.fromJSON((0,d.Ui)(this.coords))}get normalizedBounds(){const e=null!=this.normalizedCoords?this.normalizedCoords.extent:null;return null!=e?(0,h.oJ)(e):null}};(0,s._)([(0,n.Cb)()],c.prototype,"spatialReference",void 0),(0,s._)([(0,n.Cb)()],c.prototype,"element",void 0),(0,s._)([(0,n.Cb)()],c.prototype,"bounds",null),(0,s._)([(0,n.Cb)()],c.prototype,"coords",null),(0,s._)([(0,n.Cb)()],c.prototype,"normalizedCoords",null),(0,s._)([(0,n.Cb)()],c.prototype,"normalizedBounds",null),c=(0,s._)([(0,o.j)("esri.layers.support.MediaElementView")],c)},45139:(e,t,r)=>{r.r(t),r.d(t,{default:()=>se});var s=r(27366),i=(r(59486),r(52639),r(94931),r(78451),r(98689),r(57823),r(32066),r(49018),r(34999),r(28189),r(9014),r(32718)),n=(r(51508),r(40281)),o=(r(93169),r(77427)),l=r(66978),a=r(94172),h=r(49861),d=(r(25243),r(63780),r(69912)),c=r(65156),u=r(34066),p=r(66504),m=r(59568),f=r(10064),y=(r(99346),r(86741),r(42265),r(76200),r(35995),r(41978),r(87422)),_=(r(3453),r(91505),r(16889)),v=r(83826),g=(r(39484),r(80613)),w=(r(13594),r(151),r(84319),r(52120),r(8548)),x=(r(37825),r(3667),r(94109),r(84936),r(54815),r(10435),r(30575),r(41768),r(78020),r(44070)),b=(r(53634),r(46888),r(57808)),C=r(45412),R=(r(64337),r(61441),r(86909),r(82386),r(73271),r(21391),r(15245)),E=(r(10106),r(34052),r(53456),r(54711),r(99267),r(92841),r(23174),r(93985),r(13163),r(36207),r(98634),r(46228),r(78041),r(39416),r(70812),r(77318),r(26885),r(79347),r(83406),r(68860),r(49229),r(8229)),M=r(91340),V=(r(91908),r(14921),r(69610),r(37995),r(73828),r(32344)),T=r(85269),S=r(98928),O=r(92026),q=r(67593),A=r(11873),P=r(88396),z=r(6394),G=r(48202),D=r(25999),U=r(52311);const H=(0,A.a)(),L={none:G.of.None,loop:G.of.Loop,oscillate:G.of.Oscillate};class j extends y.s{constructor(e){super(),this.elementView=e,this.isWrapAround=!1,this.perspectiveTransform=(0,z.a)(),this._playHandle=null,this._vertices=new Float32Array(20),this._handles=[],this._handles.push((0,a.YP)((()=>this.elementView.element.opacity),(e=>this.opacity=e),a.nn),(0,a.YP)((()=>[this.elementView.coords]),(()=>{this.requestRender()}),a.nn),(0,a.YP)((()=>["animationOptions"in this.elementView.element&&this.elementView.element.animationOptions]),(()=>{var e;null!==(e=this._playHandle)&&void 0!==e&&e.remove(),this.texture=(0,O.M2)(this.texture),this.requestRender()}),a.nn),(0,a.gx)((()=>this.elementView.element.loaded),(()=>{const e=this.elementView.element;this.ready(),"video"===e.type&&null!=e.content&&this._handles.push((0,S.on)(e.content,"play",(()=>this.requestRender())))}),a.nn)),e.element.load().catch((t=>{i.Z.getLogger("esri.views.2d.layers.MediaLayerView2D").error(new f.Z("element-load-error","Element cannot be displayed",{element:e,error:t}))}))}destroy(){var e;null!==(e=this._playHandle)&&void 0!==e&&e.remove(),this._handles.forEach((e=>e.remove())),this.texture=(0,O.M2)(this.texture)}get dvsMat3(){return this.parent.dvsMat3}beforeRender(e){const{context:t}=e,r=this.elementView.element.content;if(null!=r){const e=r instanceof HTMLImageElement,s=r instanceof HTMLVideoElement,i=e?r.naturalWidth:s?r.videoWidth:r.width,n=e?r.naturalHeight:s?r.videoHeight:r.height;if(this._updatePerspectiveTransform(i,n),this.texture)s&&!r.paused&&(this.texture.setData(r),this.requestRender(),(t.type===v.zO.WEBGL2||(0,_.wt)(i)&&(0,_.wt)(n))&&this.texture.generateMipmap());else{const e=new U.X;if(e.wrapMode=w.e8.CLAMP_TO_EDGE,e.preMultiplyAlpha=!0,e.width=i,e.height=n,"getFrame"in r){const s=r=>{this.texture?this.texture.setData(r):this.texture=new b.x(t,e,r),this.requestRender()};"animationOptions"in this.elementView.element&&(this._playHandle=(0,D.hY)(r,function(e){return e?{...e,playAnimation:e.playing,repeatType:e.repeatType?L[e.repeatType]:void 0}:{}}(this.elementView.element.animationOptions),null,s))}else this.texture=new b.x(t,e,r);(t.type===v.zO.WEBGL2||(0,_.wt)(i)&&(0,_.wt)(n))&&this.texture.generateMipmap(),s&&!r.paused&&this.requestRender()}}super.beforeRender(e)}_createTransforms(){return null}updateDrawCoords(e,t){const r=this.elementView.coords;if(null==r)return;const[s,i,n,o]=r.rings[0],l=this._vertices,{x:a,y:h}=e,d=0!==t;d?l.set([i[0]-a,i[1]-h,s[0]-a,s[1]-h,n[0]-a,n[1]-h,o[0]-a,o[1]-h,o[0]-a,o[1]-h,i[0]+t-a,i[1]-h,i[0]+t-a,i[1]-h,s[0]+t-a,s[1]-h,n[0]+t-a,n[1]-h,o[0]+t-a,o[1]-h]):l.set([i[0]-a,i[1]-h,s[0]-a,s[1]-h,n[0]-a,n[1]-h,o[0]-a,o[1]-h]),this.isWrapAround=d}getVAO(e,t,r){if(null==this.elementView.coords)return null;const s=this._vertices;if(this._vao)this._geometryVbo.setData(s);else{this._geometryVbo=x.f.createVertex(e,w.l1.DYNAMIC_DRAW,s);const i=x.f.createVertex(e,w.l1.STATIC_DRAW,new Uint16Array([0,0,0,1,1,0,1,1,1,1,0,0,0,0,0,1,1,0,1,1]));this._vao=new C.U(e,r,t,{geometry:this._geometryVbo,tex:i})}return this._vao}_updatePerspectiveTransform(e,t){const r=this._vertices;(0,q.E)(H,[0,0,e,0,0,t,e,t],[r[0],r[1],r[4],r[5],r[2],r[3],r[6],r[7]]),(0,P.s)(this.perspectiveTransform,H[6]/H[8]*e,H[7]/H[8]*t)}}var W=r(17842),Z=r(22753),I=r(23588),k=r(92975),B=r(86226),Q=r(62272),Y=r(64510);class N extends Y.Z{constructor(){super(...arguments),this._localOrigin=(0,W.vW)(0,0),this._viewStateId=-1,this._dvsMat3=(0,I.c)()}get dvsMat3(){return this._dvsMat3}beforeRender(e){this._updateMatrices(e),this._updateOverlays(e,this.children);for(const t of this.children)t.beforeRender(e)}prepareRenderPasses(e){const t=e.registerRenderPass({name:"overlay",brushes:[Q.U.overlay],target:()=>this.children,drawPhase:g.jx.MAP});return[...super.prepareRenderPasses(e),t]}_updateMatrices(e){const{state:t}=e,{id:r,size:s,pixelRatio:i,resolution:n,rotation:o,viewpoint:l,displayMat3:a}=t;if(this._viewStateId===r)return;const h=Math.PI/180*o,d=i*s[0],c=i*s[1],{x:u,y:p}=l.targetGeometry,m=(0,M.or)(u,t.spatialReference);this._localOrigin.x=m,this._localOrigin.y=p;const f=n*d,y=n*c,_=(0,Z.g)(this._dvsMat3);(0,Z.m)(_,_,a),(0,Z.h)(_,_,(0,R.f)(d/2,c/2)),(0,Z.c)(_,_,(0,E.f)(d/f,-c/y,1)),(0,Z.r)(_,_,-h),this._viewStateId=r}_updateOverlays(e,t){const{state:r}=e,{rotation:s,spatialReference:i,worldScreenWidth:n,size:o,viewpoint:l}=r,a=this._localOrigin;let h=0;const d=(0,k.C5)(i);if(d&&i.isWrappable){const e=o[0],c=o[1],u=180/Math.PI*s,p=Math.abs(Math.cos(u)),m=Math.abs(Math.sin(u)),f=Math.round(e*p+c*m),[y,_]=d.valid,v=(0,B.ut)(i),{x:g,y:w}=l.targetGeometry,x=[g,w],b=[0,0];r.toScreen(b,x);const C=[0,0];let R;R=f>n?.5*n:.5*f;const E=Math.floor((g+.5*v)/v),M=y+E*v,V=_+E*v,T=[b[0]+R,0];r.toMap(C,T),C[0]>V&&(h=v),T[0]=b[0]-R,r.toMap(C,T),C[0]<M&&(h=-v);for(const r of t){const e=r.elementView.bounds;if(null==e)continue;const[t,,s]=e;t<y&&s>y?r.updateDrawCoords(a,v):s>_&&t<_?r.updateDrawCoords(a,-v):r.updateDrawCoords(a,h)}}else for(const c of t)c.updateDrawCoords(a,h)}}var F=r(95986),J=r(67581),X=r(53866);let K=class extends((0,F.y)(J.Z)){constructor(){super(...arguments),this._overlayContainer=null,this._fetchQueue=null,this._tileStrategy=null,this._elementReferences=new Map,this._debugGraphicsView=null,this.layer=null,this.elements=new n.Z}attach(){this.addAttachHandles([(0,a.on)((()=>this.layer.effectiveSource),"refresh",(()=>{this._tileStrategy.refresh((e=>this._updateTile(e))),this.requestUpdate()})),(0,a.on)((()=>this.layer.effectiveSource),"change",(e=>{let{element:t}=e;return this._elementUpdateHandler(t)}))]),this._overlayContainer=new N,this.container.addChild(this._overlayContainer),this._fetchQueue=new V.Z({tileInfoView:this.view.featuresTilingScheme,concurrency:10,process:(e,t)=>this._queryElements(e,t)}),this._tileStrategy=new T.Z({cachePolicy:"purge",resampling:!0,acquireTile:e=>this._acquireTile(e),releaseTile:e=>this._releaseTile(e),tileInfoView:this.view.featuresTilingScheme}),this.requestUpdate()}detach(){var e;this.elements.removeAll(),this._tileStrategy.destroy(),this._fetchQueue.destroy(),this._overlayContainer.removeAllChildren(),this.container.removeAllChildren(),this._elementReferences.clear(),null===(e=this._debugGraphicsView)||void 0===e||e.destroy()}supportsSpatialReference(e){return!0}moveStart(){this.requestUpdate()}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}update(e){var t;this._tileStrategy.update(e),null===(t=this._debugGraphicsView)||void 0===t||t.update(e)}async hitTest(e,t){const r=[],s=e.normalize(),i=[s.x,s.y];for(const{projectedElement:{normalizedCoords:n,element:o}}of this._elementReferences.values())null!=n&&(0,u.wP)(n.rings,i)&&r.push({type:"media",element:o,layer:this.layer,mapPoint:e,sourcePoint:o.toSource(e)});return r.reverse()}canResume(){return null!=this.layer.source&&super.canResume()}async doRefresh(){this._fetchQueue.reset(),this._tileStrategy.refresh((e=>this._updateTile(e)))}_acquireTile(e){const t=new re(e.clone());return this._updateTile(t),t}_updateTile(e){this._updatingHandles.addPromise(this._fetchQueue.push(e.key).then((t=>{const[r,s]=e.setElements(t);this._referenceElements(e,r),this._dereferenceElements(e,s),this.requestUpdate()}),(e=>{(0,l.D_)(e)||i.Z.getLogger(this).error(e)})))}_releaseTile(e){this._fetchQueue.abort(e.key.id),e.elements&&this._dereferenceElements(e,e.elements),this.requestUpdate()}async _queryElements(e,t){const r=this.layer.effectiveSource;if(null==r)return[];this.view.featuresTilingScheme.getTileBounds($,e,!0);const s=new X.Z({xmin:$[0],ymin:$[1],xmax:$[2],ymax:$[3],spatialReference:this.view.spatialReference});return r.queryElements(s,t)}_referenceElements(e,t){if(null!=this.layer.source)for(const r of t)this._referenceElement(e,r)}_referenceElement(e,t){(0,o.s1)(this._elementReferences,t.uid,(()=>{const e=new m.L({element:t,spatialReference:this.view.spatialReference}),r=new j(e);this._overlayContainer.addChild(r),this.elements.add(t);return{tiles:new Set,projectedElement:e,overlay:r,debugGraphic:null}})).tiles.add(e)}_dereferenceElements(e,t){for(const r of t)this._dereferenceElement(e,r)}_dereferenceElement(e,t){var r;const s=this._elementReferences.get(t.uid);s.tiles.delete(e),s.tiles.size||(this._overlayContainer.removeChild(s.overlay),s.overlay.destroy(),s.projectedElement.destroy(),this._elementReferences.delete(t.uid),this.elements.remove(t),null===(r=this._debugGraphicsView)||void 0===r||r.graphics.remove(s.debugGraphic))}_elementUpdateHandler(e){let t=this._elementReferences.get(e.uid);if(t){var r,s;const i=t.projectedElement.normalizedCoords;if(null==i)return this._overlayContainer.removeChild(t.overlay),t.overlay.destroy(),t.projectedElement.destroy(),this._elementReferences.delete(e.uid),this.elements.remove(e),void(null===(r=this._debugGraphicsView)||void 0===r||r.graphics.remove(t.debugGraphic));const n=[],o=[];for(const e of this._tileStrategy.tiles){const r=te(this.view.featuresTilingScheme,e,i);t.tiles.has(e)?r||o.push(e):r&&n.push(e)}for(const t of n)this._referenceElement(t,e);for(const t of o)this._dereferenceElement(t,e);return t=this._elementReferences.get(e.uid),void((null===(s=t)||void 0===s?void 0:s.debugGraphic)&&(t.debugGraphic.geometry=t.projectedElement.normalizedCoords,this._debugGraphicsView.graphicUpdateHandler({graphic:t.debugGraphic,property:"geometry"})))}const i=new m.L({element:e,spatialReference:this.view.spatialReference}).normalizedCoords;if(null!=i)for(const n of this._tileStrategy.tiles)te(this.view.featuresTilingScheme,n,i)&&this._referenceElement(n,e)}};(0,s._)([(0,h.Cb)()],K.prototype,"layer",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],K.prototype,"elements",void 0),K=(0,s._)([(0,d.j)("esri.views.2d.layers.MediaLayerView2D")],K);const $=(0,c.Ue)(),ee={xmin:0,ymin:0,xmax:0,ymax:0};function te(e,t,r){return e.getTileBounds($,t.key,!0),ee.xmin=$[0],ee.ymin=$[1],ee.xmax=$[2],ee.ymax=$[3],(0,p.Nl)(ee,r)}class re{constructor(e){this.key=e,this.elements=null,this.isReady=!1,this.visible=!0}setElements(e){const t=[],r=new Set(this.elements);this.elements=e;for(const s of e)r.has(s)?r.delete(s):t.push(s);return this.isReady=!0,[t,Array.from(r)]}destroy(){}}const se=K}}]);
//# sourceMappingURL=5139.74432412.chunk.js.map